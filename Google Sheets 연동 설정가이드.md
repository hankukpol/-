# Google Sheets 연동 설정 가이드

## 📋 개요
이 가이드는 업무분장 시스템을 Google Sheets와 연동하여 여러 기기에서 데이터를 공유할 수 있도록 설정하는 방법을 안내합니다.

---

## 🚀 설정 단계

### Step 1: Google Sheets 생성

1. [Google Sheets](https://sheets.google.com)에 접속
2. **새 스프레드시트 만들기** 클릭
3. 스프레드시트 이름을 `한국경찰학원 업무분장`으로 변경

### Step 2: Apps Script 설정

1. Google Sheets에서 **확장 프로그램** → **Apps Script** 클릭
2. 기본 코드를 모두 삭제
3. 제공된 `Code.gs` 파일의 내용을 복사하여 붙여넣기
4. **저장** 버튼 클릭 (Ctrl+S)

### Step 3: Web App 배포

1. Apps Script 편집기에서 **배포** → **새 배포** 클릭
2. **유형 선택** → **웹 앱** 선택
3. 다음 설정 입력:
   - **설명**: `업무분장 API v1` (선택사항)
   - **다음 사용자로 실행**: **나**
   - **액세스 권한**: **나만** (개인용) 또는 **모든 사용자** (팀 공유용)
4. **배포** 버튼 클릭
5. **액세스 승인** → Google 계정 선택 → **고급** → **안전하지 않은 페이지로 이동** → **허용**
6. **웹 앱 URL** 복사 (예: `https://script.google.com/macros/s/AKfycby.../exec`)

### Step 4: HTML 파일 설정

1. `한국경찰학원 업무분장.html` 파일을 브라우저에서 열기
2. 우측 상단의 **⚙️ 설정** 아이콘 클릭
3. **Google Sheets 동기화** 섹션에 복사한 Web App URL 붙여넣기
4. **연결 테스트** 버튼 클릭하여 연결 확인
5. ✅ 연결 성공 메시지 확인 후 **저장 및 연결** 버튼 클릭

---

## ✅ 동작 확인

### 데이터 마이그레이션
- 첫 실행 시 기존 LocalStorage 데이터가 자동으로 Google Sheets로 이동됩니다
- 네비게이션 바에 **☁️ 동기화됨** 또는 **🔄 동기화 중...** 표시 확인

### 다중 기기 테스트
1. 한 브라우저에서 업무 추가/수정
2. 다른 브라우저(또는 다른 컴퓨터)에서 페이지 새로고침
3. 변경사항이 동기화되었는지 확인

---

## 🔧 문제 해결

### "연결 실패" 오류
- Web App URL이 정확한지 확인
- Apps Script 배포 시 **액세스 권한**을 올바르게 설정했는지 확인
- 브라우저 콘솔(F12)에서 상세 오류 메시지 확인

### "⚠️ 오프라인" 표시
- 인터넷 연결 확인
- Google Sheets가 삭제되지 않았는지 확인
- LocalStorage 캐시로 계속 작동하며, 연결 복구 시 자동 동기화됨

### 데이터가 동기화되지 않음
- Google Sheets에서 **확장 프로그램** → **Apps Script** → **실행** 탭에서 오류 로그 확인
- Apps Script 코드가 올바르게 붙여넣어졌는지 확인

---

## 📊 Google Sheets 구조

배포 후 Google Sheets에 자동으로 3개의 시트가 생성됩니다:

- **roles**: 직책 정보 (5개 직책)
- **tasks**: 업무 목록 (30개 업무)
- **principles**: 운영 원칙 (4개 원칙)

> **참고**: 시트를 직접 수정할 수도 있지만, HTML 인터페이스를 통해 수정하는 것을 권장합니다.

---

## 🔒 보안 및 권한

- **나만**: 본인만 데이터 접근 가능 (개인용)
- **모든 사용자**: URL을 아는 모든 사람이 접근 가능 (팀 공유용)
- 민감한 데이터가 포함된 경우 **나만** 권한 사용 권장

---

## 💡 추가 팁

- **백업**: Google Sheets는 자동으로 버전 기록을 저장하므로 별도 백업 불필요
- **복원**: **파일** → **버전 기록** → **버전 기록 보기**에서 이전 버전 복원 가능
- **공유**: Google Sheets 자체를 다른 사용자와 공유하여 협업 가능
